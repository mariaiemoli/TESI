%% Two phase flow
% Equazione di saturazione: equazione iperbolica non lineare
% 
%       u_t+f(u)_x = 0
% dove 
%       f( u ) =  u^2/( u^2 + a(1-u)^2 )
%
%

% Proviamo a risolverla con il metodo di Godunov entropico


close all

clear all
clc

%%
%figure()
global bc landa0
bc='f'; 
landa0=0.9; 
nx=500;

A=0;
B=300;

%flux=inline('(x.^2)./( (x.^2)+2*(1-x).^2 )');
%flux1=inline('4*x.*(1-x)./((x.^2+2**(1-x).^2).^2)');

%flux=inline('(x.^2)./( (x.^2)+0.5*(1-x).^2 )');
%flux1=inline('x.*(1-x)./((x.^2+0.5*(1-x).^2).^2)');

flux=inline('(0.1*x)./( x+0.5*(1-x) )');
flux1=inline('0.1*0.5./((x+0.5*(1-x)).^2)');


x=linspace(A,B,nx);

%plot(x,flux(x))
cfl=1.8;
%%

figure()
u0=rieman(1,0,nx,x,1);

hold on

T1 = 200.0;
T2 = 5.0;
T3 = 10.0;
T4 = 20.0;
T5 = 0.9;
T6 = 1.2;
plot(x,u0,'r','Linewidth',2)

axis([A B 0. 1.2])

%%
% T1

[u,x]=god_e(u0,flux,flux1,T1,cfl,[A,B]);

hold on
plot(x,u,'g','Linewidth',2)

%%
figure()

hold on
plot(x,u,'g','Linewidth',2)

v1 = [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.999995, 0.999932, 0.999549, 0.998052, 0.99382, 0.984556, 0.968082, 0.9433, 0.910609, 0.871585, 0.828301, 0.782755, 0.736559, 0.690876, 0.646467, 0.603782, 0.563055, 0.524373, 0.487733, 0.453072, 0.420298, 0.389302, 0.359969, 0.332186, 0.305839, 0.280824, 0.257042, 0.234398, 0.212808, 0.192189, 0.172467, 0.15357, 0.13543, 0.117981, 0.101153, 0.0848727, 0.069052, 0.0535673, 0.0382025, 0.0223985, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

plot ( x, v1, 'c--', 'Linewidth',2)

%%
% T2

[u,x]=god_e(u0,flux,flux1,T2,cfl,[A,B]);

hold on
plot(x,u,'g','Linewidth',2)

%%
% T3

[u,x]=god_e(u0,flux,flux1,T3,cfl,[0,3]);

hold on
plot(x,u,'g','Linewidth',2)

%%
% T4

[u,x]=god_e(u0,flux,flux1,T4,cfl,[0,50]);

hold on
plot(x,u,'g','Linewidth',2)

%%
vv = [ 0, 1.41422e-59, 3.44552e-55, 5.21014e-51, 6.56289e-47, 7.6131e-43, 8.47835e-39, 9.23993e-35, 9.94921e-31, 1.06384e-26, 1.1328e-22, 1.2032e-18, 1.27597e-14, 1.35182e-10, 1.4311e-06, 0.00827158, 0.329789, 0.845733, 0.980342, 0.997759, 0.99975, 0.999973, 0.999997, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.99996, 0.999554, 0.99758, 0.991438, 0.977637, 0.953454, 0.918404, 0.874276, 0.824051, 0.770741, 0.716755, 0.663746, 0.612721, 0.564211, 0.518437, 0.475424, 0.435089, 0.397287, 0.361847, 0.328589, 0.297335, 0.267915, 0.240171, 0.213954, 0.189126, 0.16556, 0.143134, 0.12173, 0.10123, 0.0815009, 0.0623759, 0.043589, 0.024511, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.41422e-59 ];

figure()
plot(x,u,'g','Linewidth',2)
hold on
plot(x,vv,'k','Linewidth',2)


%% versione 2

v = [ 0, 1.41422e-59, 3.44552e-55, 5.21014e-51, 6.56289e-47, 7.6131e-43, 8.47835e-39, 9.23993e-35, 9.94921e-31, 1.06384e-26, 1.1328e-22, 1.2032e-18, 1.27597e-14, 1.35182e-10, 1.4311e-06, 0.00827158, 0.329789, 0.845733, 0.980342, 0.997759, 0.99975, 0.999973, 0.999997, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.99996, 0.999554, 0.99758, 0.991438, 0.977637, 0.953454, 0.918404, 0.874276, 0.824051, 0.770741, 0.716755, 0.663746, 0.612721, 0.564211, 0.518437, 0.475424, 0.435089, 0.397287, 0.361847, 0.328589, 0.297335, 0.267915, 0.240171, 0.213954, 0.189126, 0.16556, 0.143134, 0.12173, 0.10123, 0.0815009, 0.0623759, 0.043589, 0.024511, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.41422e-59 ];
figure()
plot(x,u,'g','Linewidth',2)
hold on
plot(x,v,'k','Linewidth',2)

%% versione 3

v = [ 0, 1.41422e-59, 3.44552e-55, 5.21014e-51, 6.56289e-47, 7.6131e-43, 8.47835e-39, 9.23993e-35, 9.94921e-31, 1.06384e-26, 1.1328e-22, 1.2032e-18, 1.27597e-14, 1.35182e-10, 1.4311e-06, 0.00827158, 0.329789, 0.845733, 0.980342, 0.997759, 0.99975, 0.999973, 0.999997, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.99996, 0.999554, 0.99758, 0.991438, 0.977637, 0.953454, 0.918404, 0.874276, 0.824051, 0.770741, 0.716755, 0.663746, 0.612721, 0.564211, 0.518437, 0.475424, 0.435089, 0.397287, 0.361847, 0.328589, 0.297335, 0.267915, 0.240171, 0.213954, 0.189126, 0.16556, 0.143134, 0.12173, 0.10123, 0.0815009, 0.0623759, 0.043589, 0.024511, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.41422e-59 ];
figure()
plot(x,u,'g','Linewidth',2)
hold on
plot(x,v,'k','Linewidth',2)
