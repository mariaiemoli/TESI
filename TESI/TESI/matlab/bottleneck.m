%% RISULTATI BOTTLENECK

clear all
close all
clc

x=linspace(0,1);
flux=inline('x.*(1-x)');
flux2=inline('x.*(1-3/2.*x)');

plot(x,flux(x), 'Linewidth',2)
hold on
plot(x,flux2(x),'g', 'Linewidth',2)

axis([0 1.2 0 0.3])

xlabel('u')
ylabel('f')

%legend('f1', 'f2')

%%
nx=160;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v0 = [ 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v0, 'r--', 'Linewidth',2)
hold on



v1 = [ 0.366645, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660003, 0.660018, 0.660106, 0.660589, 0.663025, 0.673979, 0.712648, 0.797484, 0.895807, 0.95859, 0.984303, 0.991749, 0.993208, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v1, 'y--', 'Linewidth',2)

%%
v2 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v2, 'c--', 'Linewidth',2)

vv = [ 0.25, 0.250003, 0.251118, 0.422104, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660003, 0.660013, 0.660054, 0.660225, 0.66093, 0.663784, 0.674702, 0.709621, 0.784507, 0.875614, 0.940422, 0.97248, 0.985621, 0.990578, 0.992379, 0.99302, 0.993243, 0.993319, 0.993344, 0.993352, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, vv, 'r--', 'Linewidth',2)

%%

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.250047, 0.262935, 0.583468, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660006, 0.660022, 0.660085, 0.660325, 0.661247, 0.664715, 0.676972, 0.71303, 0.785389, 0.871683, 0.93507, 0.968538, 0.983362, 0.989426, 0.991826, 0.992763, 0.993127, 0.993267, 0.993322, 0.993343, 0.993351, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v3, 'm--', 'Linewidth',2)

%%

v4 = [ 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v4, 'm--', 'Linewidth',2)


%%

figure
subplot(2,2,1)
plot(x, v1)
subplot(2,2,2)
plot(x, v2)
subplot(2,2,3)
plot(x, v3 )
subplot(2,2,4)
plot(x, v4 )

%% cambio dato iniziale, TEST B2

v0 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

plot (x, v0, 'r--', 'Linewidth',2)
hold on


% T = 0.1
v1 = [ 0.4, 0.372753, 0.329722, 0.282028, 0.233501, 0.185642, 0.139511, 0.0964442, 0.0585001, 0.0286211, 0.00966875, 0.00160921, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

plot (x, v1, 'y--', 'Linewidth',2)

%%

% T = 2

v2 = [ 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.399999, 0.399998, 0.399995, 0.399988, 0.399972, 0.399941, 0.399884, 0.399783, 0.399618, 0.399363, 0.398989, 0.398468, 0.397777, 0.396897, 0.395816, 0.394534, 0.393054, 0.391387, 0.389547, 0.38755, 0.385414, 0.383156, 0.38079, 0.378332, 0.375793, 0.373186, 0.370519, 0.367801, 0.365039, 0.362239, 0.359407, 0.356546, 0.35366, 0.350753, 0.347828, 0.344886, 0.34193, 0.338961, 0.335981, 0.332991, 0.329993, 0.326987, 0.323974, 0.320955, 0.317931, 0.314901, 0.311868, 0.30883, 0.305789, 0.302745, 0.299698, 0.296648, 0.293596, 0.290542, 0.287486, 0.284429, 0.28137, 0.27831, 0.275248, 0.272186, 0.269122, 0.266058, 0.262993, 0.259927, 0.256861, 0.253794, 0.250727, 0.456647, 0.312717, 0.300526, 0.289676, 0.2797, 0.27044, 0.261818, 0.253776, 0.246262, 0.239225, 0.232617, 0.226387, 0.22049, 0.214886, 0.209538, 0.204416, 0.199493, 0.194747, 0.190159, 0.185713, 0.181396, 0.177196, 0.173103, 0.169107, 0.165202, 0.161379, 0.157634, 0.153961, 0.150354, 0.14681, 0.143325, 0.139895, 0.136517, 0.133188, 0.129906, 0.126668, 0.123472, 0.120316, 0.117198, 0.114117, 0.111071, 0.108059, 0.105079, 0.102131, 0.0992127, 0.0963241, 0.093464, 0.0906317, 0.0878266, 0.085048, 0.0822955, 0.0795687, 0.0768672, 0.0741907, 0.0715392, 0.0689124, 0.0663105, 0.0637334, 0.0611814, 0.0586548, 0.0561539, 0.0536793, 0.0512316, 0.0488115, 0.0464199, 0.044058, 0.0417269, 0.0394282, 0.0371633, 0.0349342, 0.0327431, 0.0305922, 0.0284843, 0.0264224, 0.0244098, 0.0224501, 0.0205475, 0.0187061, 0.0169309, 0 ];

plot (x, v2, 'c--', 'Linewidth',2)

%%

% T = 4

v3 = [ 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.399999, 0.399998, 0.399997, 0.399994, 0.39999, 0.399983, 0.399972, 0.399955, 0.399929, 0.399891, 0.399836, 0.39976, 0.399656, 0.39952, 0.399343, 0.399119, 0.398843, 0.398508, 0.39811, 0.397647, 0.397114, 0.396513, 0.395843, 0.395106, 0.507294, 0.768133, 0.788247, 0.788667, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.329852, 0.327703, 0.325703, 0.323771, 0.321879, 0.320015, 0.318171, 0.316342, 0.314525, 0.312719, 0.310921, 0.309132, 0.30735, 0.305573, 0.303803, 0.302039, 0.300279, 0.298524, 0.296775, 0.295029, 0.293289, 0.291552, 0.28982, 0.288092, 0.286369, 0.284649, 0.282934, 0.281223, 0.279516, 0.277813, 0.276115, 0.27442, 0.27273, 0.271044, 0.269363, 0.267686, 0.266013, 0.264344, 0.26268, 0.261021, 0.259366, 0.257715, 0.256069, 0.254428, 0.252792, 0.25116, 0.249533, 0.247911, 0.246293, 0.244681, 0.243073, 0.241471, 0.239873, 0.23828, 0.236693, 0.23511, 0.233532, 0.23196, 0.230392, 0.22883, 0.227273, 0.225721, 0.224174, 0.222632, 0.221095, 0.219563, 0.218036, 0.216515, 0.214998, 0.213486, 0.21198, 0.210478, 0.208981, 0.207489, 0.206003, 0.20452, 0.203043, 0.201571, 0 ];

plot (x, v3, 'm--', 'Linewidth',2)

vv = [ 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];
hold on
plot (x, vv, 'c--', 'Linewidth',2)

%%

% T = 10

v4 = [ 0.4, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.332333, 0.331715, 0.331139, 0.330582, 0.330037, 0.329499, 0.328967, 0.328438, 0.327913, 0.32739, 0.326869, 0.326349, 0.325832, 0.325315, 0.3248, 0.324285, 0.323772, 0.323259, 0.322747, 0.322235, 0.321724, 0.321214, 0.320704, 0.320195, 0.319686, 0.319177, 0.318669, 0.318161, 0.317653, 0.317146, 0.316639, 0.316133, 0.315626, 0.31512, 0.314614, 0.314108, 0.313603, 0.313097, 0.312592, 0.312088, 0.311583, 0.311078, 0.310574, 0.31007, 0.309566, 0.309062, 0.308558, 0.308055, 0.307551, 0.307048, 0.306545, 0.306042, 0.305539, 0.305037, 0.304534, 0.304032, 0.303529, 0.303027, 0.302525, 0.302023, 0.301522, 0.30102, 0.300518, 0.300017, 0.299516, 0.299014, 0.298513, 0.298012, 0.297511, 0.297011, 0.29651, 0.29601, 0.295509, 0.295009, 0.294509, 0.294009, 0.293509, 0.293009, 0 ];

plot (x, v4, 'g--', 'Linewidth',2)


%%


figure
subplot(2,2,1)
plot(x, v1)
subplot(2,2,2)
plot(x, v2)
subplot(2,2,3)
plot(x, v3 )
subplot(2,2,4)
plot(x, v4 )

%%
% h=0.1, TEST1
close all
clear all
clc

nx=20;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.484772, 0.660273, 0.661667, 0.669053, 0.700058, 0.781584, 0.890312, 0.962734, 0.988821, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.306665, 0.65356, 0.66, 0.66, 0.660002, 0.66001, 0.660053, 0.660264, 0.661248, 0.665528, 0.682004, 0.730286, 0.817558, 0.905876, 0.960037, 0.983336, 0.991037, 0.992985, 0.993325, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.250409, 0.340816, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660015, 0.660065, 0.660267, 0.661077, 0.664212, 0.675536, 0.709637, 0.780288, 0.867632, 0.933689, 0.968962, 0.984335, 0.990288, 0.992401, 0.993088, 0.99329, 0.993342, 0.993353, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

e1=0;
e2=0;
%%
for i= 1:19
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end

for i= 1:39
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
end

%%
% h=0.05, TEST1
close all
clear all
clc

nx=40;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.306665, 0.65356, 0.66, 0.66, 0.660002, 0.66001, 0.660053, 0.660264, 0.661248, 0.665528, 0.682004, 0.730286, 0.817558, 0.905876, 0.960037, 0.983336, 0.991037, 0.992985, 0.993325, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.250409, 0.340816, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660015, 0.660065, 0.660267, 0.661077, 0.664212, 0.675536, 0.709637, 0.780288, 0.867632, 0.933689, 0.968962, 0.984335, 0.990288, 0.992401, 0.993088, 0.99329, 0.993342, 0.993353, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];


e1=0;
e2=0;
%%
for i= 1:39
    e1 = e1 + h*abs( v1(i)-v2(2*i));    
end


for i= 1:79
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));    
end

%%
% h=0.025, TEST1
close all
clear all
clc

nx=80;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.250409, 0.340816, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660015, 0.660065, 0.660267, 0.661077, 0.664212, 0.675536, 0.709637, 0.780288, 0.867632, 0.933689, 0.968962, 0.984335, 0.990288, 0.992401, 0.993088, 0.99329, 0.993342, 0.993353, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.250035, 0.260992, 0.576198, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660017, 0.660068, 0.66028, 0.661147, 0.664623, 0.677676, 0.717624, 0.797175, 0.886431, 0.946184, 0.97481, 0.986421, 0.990814, 0.992431, 0.993021, 0.993235, 0.993312, 0.99334, 0.99335, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];


e1=0;
e2=0;

%%

for i= 1:79
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end


for i= 1:159
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
    
end

%%
% h=0.0125, TEST1
close all
clear all
clc

nx=160;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);


v1 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.250035, 0.260992, 0.576198, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660017, 0.660068, 0.66028, 0.661147, 0.664623, 0.677676, 0.717624, 0.797175, 0.886431, 0.946184, 0.97481, 0.986421, 0.990814, 0.992431, 0.993021, 0.993235, 0.993312, 0.99334, 0.99335, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.250007, 0.253074, 0.502144, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660002, 0.660008, 0.660038, 0.660181, 0.660859, 0.664034, 0.677869, 0.725101, 0.819514, 0.913157, 0.964243, 0.983885, 0.990394, 0.992441, 0.993075, 0.993269, 0.993329, 0.993348, 0.993353, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

e1=0;
e2=0;

%%

for i= 1:159
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end


for i= 1:319
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
    
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
% h=0.1, TEST2
close all
clear all
clc

nx=20;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.352106, 0.268711, 0.199305, 0.141567, 0.09522, 0.0600233, 0.0351349, 0.0189609, 0.0164724, 0, 0, 0, 0, 0, 0, 0, 0.401319, 0.974131, 0.999549 ];

v2 = [ 0.415144, 0.36403, 0.31779, 0.274669, 0.234258, 0.196555, 0.161735, 0.130061, 0.101824, 0.077289, 0.056632, 0.0398831, 0.0268852, 0.0172854, 0.0105702, 0.00613666, 0.00337967, 0.00176584, 0.00160703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0443685, 0.834178, 0.996518, 0.999936, 0.999999, 1 ];

v3 = [ 0.454223, 0.426106, 0.400095, 0.375141, 0.350898, 0.32722, 0.30404, 0.281337, 0.259111, 0.237384, 0.21619, 0.195578, 0.175608, 0.156351, 0.137888, 0.120313, 0.103723, 0.0882209, 0.0739098, 0.0608841, 0.0492231, 0.0389813, 0.03018, 0.0227996, 0.0167766, 0.0120048, 0.00834235, 0.0056241, 0.00367562, 0.00232778, 0.00142835, 0.000849304, 0.000489511, 0.00027361, 0.000148391, 7.8136e-05, 3.997e-05, 1.98759e-05, 1.78354e-05, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0425751, 0.835647, 0.996831, 0.999947, 0.999999, 1, 1, 1, 1, 1, 1 ];

e1=0;
e2=0;
%%
for i= 1:19
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end

for i= 1:39
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
end

%%
% h=0.05, TEST1
close all
clear all
clc

nx=40;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.306665, 0.65356, 0.66, 0.66, 0.660002, 0.66001, 0.660053, 0.660264, 0.661248, 0.665528, 0.682004, 0.730286, 0.817558, 0.905876, 0.960037, 0.983336, 0.991037, 0.992985, 0.993325, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.250409, 0.340816, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660015, 0.660065, 0.660267, 0.661077, 0.664212, 0.675536, 0.709637, 0.780288, 0.867632, 0.933689, 0.968962, 0.984335, 0.990288, 0.992401, 0.993088, 0.99329, 0.993342, 0.993353, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];


e1=0;
e2=0;
%%
for i= 1:39
    e1 = e1 + h*abs( v1(i)-v2(2*i));    
end


for i= 1:79
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));    
end

%%
% h=0.025, TEST1
close all
clear all
clc

nx=80;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.250409, 0.340816, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660015, 0.660065, 0.660267, 0.661077, 0.664212, 0.675536, 0.709637, 0.780288, 0.867632, 0.933689, 0.968962, 0.984335, 0.990288, 0.992401, 0.993088, 0.99329, 0.993342, 0.993353, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.250035, 0.260992, 0.576198, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660017, 0.660068, 0.66028, 0.661147, 0.664623, 0.677676, 0.717624, 0.797175, 0.886431, 0.946184, 0.97481, 0.986421, 0.990814, 0.992431, 0.993021, 0.993235, 0.993312, 0.99334, 0.99335, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];


e1=0;
e2=0;

%%

for i= 1:79
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end


for i= 1:159
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
    
end

%%
% h=0.0125, TEST1
close all
clear all
clc

nx=160;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);


v1 = [ 0.25, 0.250004, 0.251219, 0.422001, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660005, 0.660021, 0.660084, 0.660327, 0.661263, 0.664804, 0.677352, 0.714182, 0.787485, 0.873893, 0.93666, 0.969492, 0.983904, 0.989731, 0.991997, 0.992857, 0.993177, 0.993294, 0.993335, 0.993349, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v2 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.250035, 0.260992, 0.576198, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660017, 0.660068, 0.66028, 0.661147, 0.664623, 0.677676, 0.717624, 0.797175, 0.886431, 0.946184, 0.97481, 0.986421, 0.990814, 0.992431, 0.993021, 0.993235, 0.993312, 0.99334, 0.99335, 0.993354, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.250007, 0.253074, 0.502144, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660002, 0.660008, 0.660038, 0.660181, 0.660859, 0.664034, 0.677869, 0.725101, 0.819514, 0.913157, 0.964243, 0.983885, 0.990394, 0.992441, 0.993075, 0.993269, 0.993329, 0.993348, 0.993353, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

e1=0;
e2=0;

%%

for i= 1:159
    e1 = e1 + h*abs( v1(i)-v2(2*i));
    
end


for i= 1:319
    e2 = e2 + h/2*abs( v2(i)-v3(2*i));
    
end


%%
nx=20;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v1 = [ 0.304859, 0.655366, 0.66, 0.66, 0.66, 0.66, 0.660004, 0.660035, 0.660266, 0.661815, 0.670969, 0.712253, 0.814085, 0.921509, 0.973874, 0.98936, 0.992737, 0.993291, 0.993352, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v1, 'g--', 'Linewidth',2)

vv = [ 0.484772, 0.660273, 0.661667, 0.669053, 0.700058, 0.781584, 0.890312, 0.962734, 0.988821, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];;

plot (x, vv, 'c--', 'Linewidth',2)