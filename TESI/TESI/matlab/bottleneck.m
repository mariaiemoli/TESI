%% RISULTATI BOTTLENECK

clear all
close all
clc

x=linspace(0,1);
flux=inline('x.*(1-x)');
flux2=inline('x.*(1-3/2.*x)');

plot(x,flux(x))
hold on
plot(x,flux2(x),'g')

axis([0 1.2 0 0.3])

xlabel('u')
ylabel('f')

%legend('f1', 'f2')

%%
nx=160;

A=0.;
B=2.;

h = (B-A)/nx;

x=linspace(A+h/2,B-h/2,nx-1);

v0 = [ 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v0, 'r--', 'Linewidth',2)
hold on



v1 = [ 0.25, 0.392783, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660012, 0.660201, 0.662457, 0.682365, 0.776651, 0.919247, 0.981037, 0.992035, 0.993262, 0.993353, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v1, 'y--', 'Linewidth',2)

%%
v2 = [ 0.25, 0.25, 0.250001, 0.25098, 0.455762, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660001, 0.660004, 0.660034, 0.660264, 0.661997, 0.674303, 0.737157, 0.871826, 0.963298, 0.988052, 0.992497, 0.993219, 0.993334, 0.993352, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v2, 'c--', 'Linewidth',2)

%%

v3 = [ 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.250023, 0.268712, 0.620662, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.660003, 0.660022, 0.660172, 0.661315, 0.669705, 0.717727, 0.845203, 0.952937, 0.986068, 0.992185, 0.993172, 0.993327, 0.993351, 0.993355, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.993356, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66, 0.66 ];

plot (x, v3, 'm--', 'Linewidth',2)


%%

figure
subplot(2,2,1)
plot(x, v1)
subplot(2,2,2)
plot(x, v2)
subplot(2,2,3)
plot(x, v3 )

%% cambio dato iniziale, TEST B2

v0 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

plot (x, v0, 'r--', 'Linewidth',2)
hold on


% T = 0.1
v1 = [ 0.4, 0.372753, 0.329722, 0.282028, 0.233501, 0.185642, 0.139511, 0.0964442, 0.0585001, 0.0286211, 0.00966875, 0.00160921, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

plot (x, v1, 'y--', 'Linewidth',2)

%%

% T = 2

v2 = [ 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.399999, 0.399998, 0.399995, 0.399988, 0.399972, 0.399941, 0.399884, 0.399783, 0.399618, 0.399363, 0.398989, 0.398468, 0.397777, 0.396897, 0.395816, 0.394534, 0.393054, 0.391387, 0.389547, 0.38755, 0.385414, 0.383156, 0.38079, 0.378332, 0.375793, 0.373186, 0.370519, 0.367801, 0.365039, 0.362239, 0.359407, 0.356546, 0.35366, 0.350753, 0.347828, 0.344886, 0.34193, 0.338961, 0.335981, 0.332991, 0.329993, 0.326987, 0.323974, 0.320955, 0.317931, 0.314901, 0.311868, 0.30883, 0.305789, 0.302745, 0.299698, 0.296648, 0.293596, 0.290542, 0.287486, 0.284429, 0.28137, 0.27831, 0.275248, 0.272186, 0.269122, 0.266058, 0.262993, 0.259927, 0.256861, 0.253794, 0.250727, 0.456647, 0.312717, 0.300526, 0.289676, 0.2797, 0.27044, 0.261818, 0.253776, 0.246262, 0.239225, 0.232617, 0.226387, 0.22049, 0.214886, 0.209538, 0.204416, 0.199493, 0.194747, 0.190159, 0.185713, 0.181396, 0.177196, 0.173103, 0.169107, 0.165202, 0.161379, 0.157634, 0.153961, 0.150354, 0.14681, 0.143325, 0.139895, 0.136517, 0.133188, 0.129906, 0.126668, 0.123472, 0.120316, 0.117198, 0.114117, 0.111071, 0.108059, 0.105079, 0.102131, 0.0992127, 0.0963241, 0.093464, 0.0906317, 0.0878266, 0.085048, 0.0822955, 0.0795687, 0.0768672, 0.0741907, 0.0715392, 0.0689124, 0.0663105, 0.0637334, 0.0611814, 0.0586548, 0.0561539, 0.0536793, 0.0512316, 0.0488115, 0.0464199, 0.044058, 0.0417269, 0.0394282, 0.0371633, 0.0349342, 0.0327431, 0.0305922, 0.0284843, 0.0264224, 0.0244098, 0.0224501, 0.0205475, 0.0187061, 0.0169309, 0 ];

plot (x, v2, 'c--', 'Linewidth',2)

%%

% T = 4

v3 = [ 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.399999, 0.399998, 0.399997, 0.399994, 0.39999, 0.399983, 0.399972, 0.399955, 0.399929, 0.399891, 0.399836, 0.39976, 0.399656, 0.39952, 0.399343, 0.399119, 0.398843, 0.398508, 0.39811, 0.397647, 0.397114, 0.396513, 0.395843, 0.395106, 0.507294, 0.768133, 0.788247, 0.788667, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.329852, 0.327703, 0.325703, 0.323771, 0.321879, 0.320015, 0.318171, 0.316342, 0.314525, 0.312719, 0.310921, 0.309132, 0.30735, 0.305573, 0.303803, 0.302039, 0.300279, 0.298524, 0.296775, 0.295029, 0.293289, 0.291552, 0.28982, 0.288092, 0.286369, 0.284649, 0.282934, 0.281223, 0.279516, 0.277813, 0.276115, 0.27442, 0.27273, 0.271044, 0.269363, 0.267686, 0.266013, 0.264344, 0.26268, 0.261021, 0.259366, 0.257715, 0.256069, 0.254428, 0.252792, 0.25116, 0.249533, 0.247911, 0.246293, 0.244681, 0.243073, 0.241471, 0.239873, 0.23828, 0.236693, 0.23511, 0.233532, 0.23196, 0.230392, 0.22883, 0.227273, 0.225721, 0.224174, 0.222632, 0.221095, 0.219563, 0.218036, 0.216515, 0.214998, 0.213486, 0.21198, 0.210478, 0.208981, 0.207489, 0.206003, 0.20452, 0.203043, 0.201571, 0 ];

plot (x, v3, 'm--', 'Linewidth',2)


%%

% T = 10

v4 = [ 0.4, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.788675, 0.332333, 0.331715, 0.331139, 0.330582, 0.330037, 0.329499, 0.328967, 0.328438, 0.327913, 0.32739, 0.326869, 0.326349, 0.325832, 0.325315, 0.3248, 0.324285, 0.323772, 0.323259, 0.322747, 0.322235, 0.321724, 0.321214, 0.320704, 0.320195, 0.319686, 0.319177, 0.318669, 0.318161, 0.317653, 0.317146, 0.316639, 0.316133, 0.315626, 0.31512, 0.314614, 0.314108, 0.313603, 0.313097, 0.312592, 0.312088, 0.311583, 0.311078, 0.310574, 0.31007, 0.309566, 0.309062, 0.308558, 0.308055, 0.307551, 0.307048, 0.306545, 0.306042, 0.305539, 0.305037, 0.304534, 0.304032, 0.303529, 0.303027, 0.302525, 0.302023, 0.301522, 0.30102, 0.300518, 0.300017, 0.299516, 0.299014, 0.298513, 0.298012, 0.297511, 0.297011, 0.29651, 0.29601, 0.295509, 0.295009, 0.294509, 0.294009, 0.293509, 0.293009, 0 ];

plot (x, v4, 'g--', 'Linewidth',2)


%%


figure
subplot(2,2,1)
plot(x, v1)
subplot(2,2,2)
plot(x, v2)
subplot(2,2,3)
plot(x, v3 )
subplot(2,2,4)
plot(x, v4 )