%% RISULTATI KAASSCHIETER

nx= 81;

A1=0.21;
B1=0.52;

h1 = (B1-A1)/nx;

x1=linspace(A1+h1/2,B1-h1/2,nx);

A2=0.11;
B2=0.21;

h2 = (B2-A2)/nx;

x2=linspace(A2+h2/2,B2-h2/2,nx);

A3=0.21;
B3=0.9;

h3 = (B3-A3)/nx;

x3=linspace(A3+h3/2,B3-h3/2,nx);

%% 1a

figure()

v1_1 = [ 0.416287, 0.417612, 0.418912, 0.420191, 0.421449, 0.422689, 0.423913, 0.425121, 0.426314, 0.427495, 0.428663, 0.42982, 0.430965, 0.432101, 0.433227, 0.434345, 0.435453, 0.436554, 0.437647, 0.438732, 0.439811, 0.440883, 0.441949, 0.443008, 0.444062, 0.445111, 0.446154, 0.447192, 0.448225, 0.449253, 0.450277, 0.451297, 0.452312, 0.453324, 0.454331, 0.455335, 0.456336, 0.457333, 0.458327, 0.459317, 0.460305, 0.46129, 0.462272, 0.463251, 0.464228, 0.465202, 0.466175, 0.467144, 0.468112, 0.469078, 0.470042, 0.471004, 0.471965, 0.472924, 0.473881, 0.474838, 0.475793, 0.476747, 0.4777, 0.478652, 0.479604, 0.480555, 0.481506, 0.482457, 0.483407, 0.484358, 0.48531, 0.486262, 0.487216, 0.488171, 0.489129, 0.490089, 0.491053, 0.492021, 0.492997, 0.493981, 0.494978, 0.495994, 0.497046, 0.498175 ];
plot (x1, v1_1, 'y--', 'Linewidth',2)

title ('frattura 1')

%%
figure()


v2_1 = [ 0, 0, 0, 0, 0, 0, 0, 0, 1.68192e-317, 1.89471e-142, 4.88114e-64, 6.47387e-29, 3.49509e-13, 3.80321e-06, 0.00473901, 0.087636, 0.234099, 0.310974, 0.34466, 0.362337, 0.373289, 0.38094, 0.386761, 0.391476, 0.395472, 0.398977, 0.40213, 0.405024, 0.407719, 0.410258, 0.412673, 0.414986, 0.417214, 0.419371, 0.421468, 0.423511, 0.425509, 0.427466, 0.429386, 0.431275, 0.433134, 0.434967, 0.436776, 0.438563, 0.440329, 0.442077, 0.443808, 0.445523, 0.447222, 0.448908, 0.450582, 0.452243, 0.453893, 0.455532, 0.457162, 0.458783, 0.460396, 0.462, 0.463598, 0.465189, 0.466774, 0.468353, 0.469927, 0.471498, 0.473064, 0.474627, 0.476188, 0.477747, 0.479305, 0.480863, 0.482421, 0.483982, 0.485547, 0.487117, 0.488697, 0.490289, 0.4919, 0.493542, 0.495238, 0.497058 ];
plot (x2, v2_1, 'y--', 'Linewidth',2)

title ('frattura 2')

%%
figure()

v3_1 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3.43646e-268, 9.28759e-132, 1.22033e-64, 1.22385e-31, 1.83514e-15, 1.32108e-07, 0.00071773, 0.034746, 0.161437, 0.268043, 0.319718, 0.345606, 0.360503, 0.370125, 0.376881, 0.381911, 0.385807, 0.388901, 0.391391, 0.393404, 0.395026, 0.396321, 0.397338, 0.398121, 0.398709, 0.39914, 0.399444, 0.399653, 0.399791, 0.399879, 0.399932, 0.399964, 0.399981, 0.399991, 0.399996, 0.399998, 0.399999, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4 ];
plot (x3, v3_1, 'y--', 'Linewidth',2)

title ('frattura 3')


%%

p0 = [ 0.00306248, -0.00479501, -0.0173133, -0.0298316, -0.0423499, -0.0548682, -0.0673865, -0.0799048, -0.0924231, -0.104941, -0.11746, -0.129978, -0.142496, -0.155015, -0.167533, -0.180051, -0.19257, -0.205088, -0.217606, -0.230124, -0.242643, -0.255161, -0.267679, -0.280198, -0.292716, -0.305234, -0.317753, -0.330271, -0.342789, -0.355307, -0.367826, -0.380344, -0.392862, -0.405381, -0.417899, -0.430417, -0.442936, -0.455454, -0.467972, -0.48049, -0.493009, -0.505527, -0.518045, -0.530564, -0.543082, -0.5556, -0.568119, -0.580637, -0.593155, -0.605673, -0.618192, -0.63071, -0.643228, -0.655747, -0.668265, -0.680783, -0.693302, -0.70582, -0.718338, -0.730857, -0.743375, -0.755893, -0.768411, -0.78093, -0.793448, -0.805966, -0.818485, -0.831003, -0.843521, -0.85604, -0.868558, -0.881076, -0.893594, -0.906113, -0.918631, -0.931149, -0.943668, -0.956186, -0.968704, -0.981223, -0.993741 ];

p1 = [ 0.993779, 0.981337, 0.968895, 0.956453, 0.94401, 0.931568, 0.919126, 0.906684, 0.894242, 0.8818, 0.869358, 0.856916, 0.844473, 0.832031, 0.819589, 0.807147, 0.794705, 0.782263, 0.769821, 0.757379, 0.744937, 0.732494, 0.720052, 0.70761, 0.695168, 0.682726, 0.670284, 0.657842, 0.6454, 0.632957, 0.620515, 0.608073, 0.595631, 0.583189, 0.570747, 0.558305, 0.545863, 0.53342, 0.520978, 0.508536, 0.496094, 0.483652, 0.47121, 0.458768, 0.446326, 0.433883, 0.421441, 0.408999, 0.396557, 0.384115, 0.371673, 0.359231, 0.346789, 0.334346, 0.321904, 0.309462, 0.29702, 0.284578, 0.272136, 0.259694, 0.247252, 0.23481, 0.222367, 0.209925, 0.197483, 0.185041, 0.172599, 0.160157, 0.147715, 0.135273, 0.12283, 0.110388, 0.0979462, 0.0855041, 0.0730619, 0.0606198, 0.0481777, 0.0357356, 0.0232934, 0.0108513, 0.00101316 ];

p2 = [ -0.0103285, -0.0246938, -0.0369618, -0.0492298, -0.0614978, -0.0737658, -0.0860338, -0.0983018, -0.11057, -0.122838, -0.135106, -0.147374, -0.159642, -0.17191, -0.184178, -0.196446, -0.208714, -0.220982, -0.23325, -0.245518, -0.257786, -0.270054, -0.282322, -0.29459, -0.306858, -0.319126, -0.331394, -0.343662, -0.35593, -0.368198, -0.380466, -0.392734, -0.405002, -0.41727, -0.429538, -0.441806, -0.454074, -0.466342, -0.47861, -0.490878, -0.503146, -0.515414, -0.527682, -0.53995, -0.552218, -0.564486, -0.576754, -0.589022, -0.60129, -0.613558, -0.625826, -0.638094, -0.650362, -0.66263, -0.674898, -0.687166, -0.699434, -0.711702, -0.72397, -0.736238, -0.748506, -0.760774, -0.773042, -0.78531, -0.797578, -0.809846, -0.822114, -0.834382, -0.84665, -0.858918, -0.871186, -0.883454, -0.895722, -0.90799, -0.920258, -0.932526, -0.944794, -0.957062, -0.96933, -0.981598, -0.993866 ];

figure
subplot(3,1,1)
plot(x1, p0(1,:))
subplot(3,1,2)
plot(x2, p1(1,:))
subplot(3,1,3)
plot(x3, p2(1,:))

%%

plot3(x1,y1,s1(1,:))
hold on
plot3(xx2,yy2,s2(1,:),'--')
plot3(xx3,yy3,s3(1,:),':')