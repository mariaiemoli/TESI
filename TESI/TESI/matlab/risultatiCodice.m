%% Risultati codice c++ 
close all
clear all
clc

b=[0.21 0.31];

%frattura 1
a1=[0.52 0];
N1=80;
t1=[0:1/N1:1]';
x1=t1*(a1(1)-b(1)) + b(1);
y1=t1*(a1(2)-b(2)) + b(2);
xx1=0.5*(x1(1:end-1)+x1(2:end));
yy1=0.5*(y1(1:end-1)+y1(2:end));
h1=1/N1*((a1(1)-b(1))^2 +(a1(2)-b(2))^2 )^0.5;
tau1=[b(1)-a1(1), b(2)-a1(2)];
n1=[-b(2)+a1(2), b(1)-a1(1)];
n1=n1/(n1(1)^2+n1(2)^2)^0.5;


%frattura 3
a3=[0.9 1];
N3=80;
t3=[0:1/N3:1]';
x3=t3*(a3(1)-b(1)) + b(1);
y3=t3*(a3(2)-b(2)) + b(2);
xx3=0.5*(x3(1:end-1)+x3(2:end));
yy3=0.5*(y3(1:end-1)+y3(2:end));

h3=1/N3*((a3(1)-b(1))^2 +(a3(2)-b(2))^2 )^0.5;
tau3=[b(1)-a3(1), b(2)-a3(2)];
n3=[-b(2)+a3(2), b(1)-a3(1)];
n3=n3/(n3(1)^2+n3(2)^2)^0.5;
d3=0.2;

%frattura 2
a2=[0.11 0];
N2=80;
t2=[0:1/N2:1]';
x2=t3*(b(1)-a2(1)) + a2(1);
y2=t2*(b(2)-a2(2)) + a2(2);
xx2=0.5*(x2(1:end-1)+x2(2:end));
yy2=0.5*(y2(1:end-1)+y2(2:end));

h2=1/N2*((a2(1)-b(1))^2 +(a2(2)-b(2))^2 )^0.5;
tau2=[b(1)-a2(1), b(2)-a2(2)];
n2=[-b(2)+a2(2), b(1)-a2(1)];
n2=n2/(n2(1)^2+n2(2)^2)^0.5;
d2=0.3;



figure(1)
plot(x1,y1,'bo-')
hold on
plot(x2,y2,'ro-')
plot(x3,y3,'go-')

%% senza darcy

% -----------------  risultati -----------------  %

 S1 = [ 0.416287, 0.417612, 0.418912, 0.420191, 0.421449, 0.422689, 0.423913, 0.425121, 0.426314, 0.427495, 0.428663, 0.42982, 0.430965, 0.432101, 0.433227, 0.434345, 0.435453, 0.436554, 0.437647, 0.438732, 0.439811, 0.440883, 0.441949, 0.443008, 0.444062, 0.445111, 0.446154, 0.447192, 0.448225, 0.449253, 0.450277, 0.451297, 0.452312, 0.453324, 0.454331, 0.455335, 0.456336, 0.457333, 0.458327, 0.459317, 0.460305, 0.46129, 0.462272, 0.463251, 0.464228, 0.465202, 0.466175, 0.467144, 0.468112, 0.469078, 0.470042, 0.471004, 0.471965, 0.472924, 0.473881, 0.474838, 0.475793, 0.476747, 0.4777, 0.478652, 0.479604, 0.480555, 0.481506, 0.482457, 0.483407, 0.484358, 0.48531, 0.486262, 0.487216, 0.488171, 0.489129, 0.490089, 0.491053, 0.492021, 0.492997, 0.493981, 0.494978, 0.495994, 0.497046, 0.498175 ];
 
 S2 = [ 0, 0, 0, 0, 0, 0, 0, 0, 1.68192e-317, 1.89471e-142, 4.88114e-64, 6.47387e-29, 3.49509e-13, 3.80321e-06, 0.00473901, 0.087636, 0.234099, 0.310974, 0.34466, 0.362337, 0.373289, 0.38094, 0.386761, 0.391476, 0.395472, 0.398977, 0.40213, 0.405024, 0.407719, 0.410258, 0.412673, 0.414986, 0.417214, 0.419371, 0.421468, 0.423511, 0.425509, 0.427466, 0.429386, 0.431275, 0.433134, 0.434967, 0.436776, 0.438563, 0.440329, 0.442077, 0.443808, 0.445523, 0.447222, 0.448908, 0.450582, 0.452243, 0.453893, 0.455532, 0.457162, 0.458783, 0.460396, 0.462, 0.463598, 0.465189, 0.466774, 0.468353, 0.469927, 0.471498, 0.473064, 0.474627, 0.476188, 0.477747, 0.479305, 0.480863, 0.482421, 0.483982, 0.485547, 0.487117, 0.488697, 0.490289, 0.4919, 0.493542, 0.495238, 0.497058 ];
 
 S3 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3.43646e-268, 9.28759e-132, 1.22033e-64, 1.22385e-31, 1.83514e-15, 1.32108e-07, 0.00071773, 0.034746, 0.161437, 0.268043, 0.319718, 0.345606, 0.360503, 0.370125, 0.376881, 0.381911, 0.385807, 0.388901, 0.391391, 0.393404, 0.395026, 0.396321, 0.397338, 0.398121, 0.398709, 0.39914, 0.399444, 0.399653, 0.399791, 0.399879, 0.399932, 0.399964, 0.399981, 0.399991, 0.399996, 0.399998, 0.399999, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4 ];
 
 
figure(2)
plot3(xx1,yy1,S1,'r')
hold on
plot3(xx2,yy2,S2,'g')
plot3(xx3,yy3,S3,'c')


figure
subplot(3,1,1)
plot(0.5*(t1(2:end)+t1(1:end-1)), S1)
subplot(3,1,2)
plot(0.5*(t2(2:end)+t2(1:end-1)), S2)
subplot(3,1,3)
plot(0.5*(t3(2:end)+t3(1:end-1)), S3)

% ************************************* %
% ************************************* %
%% con darcy

% -----------------  risultati -----------------  %

% T = 50

 S1 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4.15618e-214, 2.22857e-106, 1.09224e-52, 5.2553e-26, 8.01179e-13, 2.17896e-06, 0.00248822, 0.0572647, 0.190556, 0.284139, 0.330421, 0.355585, 0.37149, 0.382836, 0.391674, 0.399006, 0.405366, 0.411064, 0.416288, 0.42116, 0.425763, 0.430155, 0.434377, 0.43846, 0.442429, 0.446301, 0.450094, 0.453819, 0.457487, 0.461108, 0.464692, 0.468247, 0.471782, 0.475307, 0.478836, 0.482384, 0.485981, 0.48968, 0.493633 ];
 
 S2 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
 
 S3 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.05057e-259, 9.49183e-129, 7.67952e-64, 1.53191e-31, 1.51967e-15, 1.06105e-07, 0.00061738, 0.0322855, 0.159444, 0.275053, 0.335605, 0.367955, 0.386235, 0.39568, 0.399289 ];
 
 
figure(2)
plot3(xx1,yy1,S1,'r')
hold on
plot3(xx2,yy2,S2,'g')
plot3(xx3,yy3,S3,'c')


figure
subplot(3,1,1)
plot(0.5*(t1(2:end)+t1(1:end-1)), S1)
subplot(3,1,2)
plot(0.5*(t2(2:end)+t2(1:end-1)), S2)
subplot(3,1,3)
plot(0.5*(t3(2:end)+t3(1:end-1)), S3)

%%

% T = 150

 S1 = [ 0.937337, 0.937353, 0.918947, 0.898694, 0.873066, 0.832764, 0.741775, 0.492869, 0.410636, 0.41234, 0.413991, 0.415597, 0.417163, 0.418694, 0.420193, 0.421665, 0.423111, 0.424535, 0.425937, 0.427321, 0.428686, 0.430036, 0.43137, 0.432691, 0.433998, 0.435294, 0.436577, 0.43785, 0.439113, 0.440366, 0.441611, 0.442846, 0.444074, 0.445293, 0.446506, 0.447711, 0.44891, 0.450102, 0.451288, 0.452469, 0.453644, 0.454814, 0.455979, 0.457139, 0.458295, 0.459446, 0.460593, 0.461737, 0.462876, 0.464012, 0.465145, 0.466274, 0.467401, 0.468525, 0.469646, 0.470765, 0.471881, 0.472996, 0.474109, 0.47522, 0.476329, 0.477438, 0.478545, 0.479652, 0.480758, 0.481863, 0.482969, 0.484076, 0.485183, 0.486292, 0.487403, 0.488517, 0.489635, 0.490758, 0.491888, 0.493029, 0.494184, 0.495362, 0.496579, 0.497886 ];
 
 S2 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
 
 S3 = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.84443e-245, 9.53444e-122, 2.32048e-60, 8.03242e-30, 1.0498e-14, 2.66006e-07, 0.000931835, 0.037763, 0.164687, 0.270202, 0.322981, 0.350522, 0.366962, 0.377806, 0.38536, 0.390705, 0.394421, 0.396889, 0.398416, 0.399277, 0.39971, 0.3999, 0.399971, 0.399993, 0.399999, 0.4, 0.4 ];
 
 
figure(2)
plot3(xx1,yy1,S1,'r')
hold on
plot3(xx2,yy2,S2,'g')
plot3(xx3,yy3,S3,'c')


figure
subplot(3,1,1)
plot(0.5*(t1(2:end)+t1(1:end-1)), S1)
subplot(3,1,2)
plot(0.5*(t2(2:end)+t2(1:end-1)), S2)
subplot(3,1,3)
plot(0.5*(t3(2:end)+t3(1:end-1)), S3)

